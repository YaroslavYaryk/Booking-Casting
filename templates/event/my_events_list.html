{% extends 'base/auth_base.html' %}
{% load static %}
{% load widget_tweaks %}
{% load artist_tags %}

{% block messages %}{% endblock messages %}


{% block title %}
      <title>My Events</title>
{% endblock title %}


{% block content %}
<div class="card">
  <div class="card-header">
    <div class="row flex-between-center">
      <div class="col-4 col-sm-auto d-flex align-items-center pe-0">
        <h5 class="fs-0 mb-0 text-nowrap py-2 py-xl-0">Events</h5>
      </div>

      {% if has_perm %}
      <div class="col-8 col-sm-auto text-end ps-2">
        
      </div>
      {% endif %}
        
    </div>
  </div>
  <div class="card-body bg-light pb-0">
    <div class="table-responsive scrollbar">
      {% if event_team|length %}
      <table class="table table-hover table-striped overflow-hidden contract_table_list">
        <thead>
          <tr>
          <th scope="col">Date</th>
          <th scope="col">Artist</th>
          <th scope="col">Customer</th>
          <th scope="col">Venue</th>
          <th scope="col">Company</th>
          <th score="col">Price</th>
          </tr>
      </thead>
        <tbody>
          {% for team in event_team %}
              <tr class="align-middle table_contract_main_row" id="{{team.contract.id|get_name_hidden_block_contract}}">
                <td><a href="{% url 'get_event_details' team.contract.id %}">{{team.contract.date}}</a></td>
                <td class="text-nowrap">
                    <div class="d-flex align-items-center">
                    <div class="ms-2"><a href="{% url 'artist_details' team.contract.artist.id %}">{{team.contract.artist.name}}</a></div>
                    </div>
                </td>
                <td><div class="block">
                    <a href="{% url 'customer_details' team.contract.customer.id %}">{{team.contract.customer.name}}</a>
                </div></td>
                <td><div class="block">
                    <a href="{% url 'get_company_details' team.contract.company.id %}">{{team.contract.company.name}}</a>
                </div></td>
                <td><div class="block">
                    <a href="{% url 'get_venue_details' team.contract.venue.id %}">{{team.contract.venue.name}}</a>
                </div></td>
                
                <td>{{team.contract.price}} <span>NOK</span></td>
            </tr>
            {% comment %} <tr class="{{team.contract.id|get_name_hidden_block_contract}}" style="display: none;">
                <td colspan="6">
                    <div class="block" style="display: flex; justify-content:space-around; width: 100%">
                        {% if team.contract.contract_pdf_url %}
                            <a class="btn btn-success" target="blank" href="{{team.contract.contract_pdf_url}}">Contract</a>
                        {% else %}
                            <a class="btn btn-success disabled" target="blank" href="{{team.contract.contract_pdf_url}}">Contract</a>
                        {% endif %}
                        {% if hidden %}
                            <a class="btn btn-warning" href="{% url 'unhide_contract_from_user' team.contract.id  %}">Unhide</a>
                        {% else %}
                            <a class="btn btn-warning" href="{% url 'hide_contract_from_user' team.contract.id  %}">Hide</a>
                        {% endif %}
                        <a class="btn btn-info" href="{% url 'user_edit_contract' team.contract.id %}">Edit</a>
                        <a class="btn btn-secondary" href="{% url 'preview_artist_contract' team.contract.id %}">Read more</a>
                    </div>
                </td>
            </tr> {% endcomment %}
          {% endfor %}
        </tbody>
      </table>
      {% else %}
        
          <p>There is no event yet, try to add some</p>
        
      {% endif %}
    </div>
  </div>
  
  </div>

  <script>
    var contract_table = document.querySelector(".contract_table_list")
    contract_table.onclick = (e) => {
        var contract_main_row = e.target.closest(".table_contract_main_row"); 
        if (contract_main_row){
            var hidden_table_block = document.querySelector(`.${contract_main_row.id}`)
            console.log(hidden_table_block)
            if (hidden_table_block.style.display == ""){
                console.log('here1')
                hidden_table_block.style.display = "none"
            }else{
                console.log('here2')
                hidden_table_block.style.display = ""
            }
            console.log(hidden_table_block)
        }
    }
  </script>

{% endblock %}
